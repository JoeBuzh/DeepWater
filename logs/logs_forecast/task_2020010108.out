2020-10-23 15:44:53.923522: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /public/software/pgi/linux86-64/10.2/lib:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/composer_xe_2011_sp1.7.256/compiler/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/compiler/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mkl/lib/intel64:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/composer_xe_2011_sp1.7.256/compiler/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/compiler/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mkl/lib/intel64:/usr/local:/usr/lib:/lib:/lib64:/usr/lib64:/usr/local/lib64:/usr/local/lib:/usr/local/grads/lib:/public/software/intel/impi/4.1.0.024/lib:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mpirt/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mpirt/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/impi/4.1.0.024/mic/lib
2020-10-23 15:44:53.923577: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Raw ADF: 0.009761097183224085
p=1
adf=(-8.2619360080774, 5.055916071861841e-13, 2, 178, {'1%': -3.467631519151906, '5%': -2.8779183721695567, '10%': -2.575501353364474}, 347.73784324941215)
(1, 1)
ARIMA Model: p=1 d=1 q=1
                           tn
time                         
2020-01-01 00:00:00  3.709444
2020-01-01 04:00:00  3.727333
2020-01-01 08:00:00  3.745222
*** 2020-01-01 08:00:00 Forecast ***
[3.74339875 3.74933371 3.75486931 3.76042547 3.76598057 3.77153573
 3.77709088 3.78264604 3.78820119 3.79375634 3.7993115  3.80486665
 3.8104218  3.81597696 3.82153211 3.82708726 3.83264242 3.83819757
 3.84375272 3.84930788 3.85486303 3.86041818 3.86597334 3.87152849
 3.87708364 3.8826388  3.88819395 3.89374911 3.89930426 3.90485941
 3.91041457 3.91596972 3.92152487 3.92708003 3.93263518 3.93819033
 3.94374549 3.94930064 3.95485579 3.96041095 3.9659661  3.97152125]
write 2020-01-01 08:00:00 Arima data done.
sr/local/grads/lib:/public/software/intel/impi/4.1.0.024/lib:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mpirt/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mpirt/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/impi/4.1.0.024/mic/lib
2020-10-23 15:44:57.291602: W tensorflow/stream_executor/cuda/cuda_driver.cc:312] failed call to cuInit: UNKNOWN ERROR (303)
2020-10-23 15:44:57.291644: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (node1): /proc/driver/nvidia/version does not exist
2020-10-23 15:44:57.302448: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2399970000 Hz
2020-10-23 15:44:57.302627: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2ae19430e0d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-10-23 15:44:57.302651: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
This Train Shape: (2191, 10)
This Predict Shape: (60, 10)
(1533, 13)
                     watertemp        pH        DO  conductivity   turbidity     codmn      nh3n       tp        tn       day_sin  day_cos  year_sin  year_cos
time                                                                                                                                                          
2019-10-09 16:00:00  29.350000  7.350000  3.515000   2101.427000  227.693000  6.097000  0.359000  0.10800  2.126000  8.660254e-01     -0.5 -0.991646  0.128987
2019-01-25 16:00:00  16.890000  7.225000  6.387000  10603.985000  165.089000  7.183000  0.978000  0.12400  3.063000  8.660254e-01     -0.5  0.408329  0.912835
2019-02-24 12:00:00  19.543103  7.196897  7.031586  18441.606496    9.949621  8.060456  1.197069  0.13131  2.894207  8.660254e-01      0.5  0.803909  0.594753
2019-05-30 20:00:00  24.410000  6.997000  5.409000    330.004000  202.146000  1.511000  1.519000  0.38800  2.762000  9.958798e-12     -1.0  0.537742 -0.843110
2019-12-10 08:00:00  18.116667  7.397200  7.631600  13956.758000  230.957000  6.043600  1.404400  0.13100  2.724600 -3.747854e-13      1.0 -0.371488  0.928438
['codmn', 'nh3n', 'tp', 'tn']
Total Width:   102

Input Indices: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
 48 49 50 51 52 53 54 55 56 57 58 59]

Label Indices: [ 60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77
  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95
  96  97  98  99 100 101]

Label Column Names: ['codmn', 'nh3n', 'tp', 'tn']
Epoch 1/10
 1/45 [..............................] - ETA: 0s - loss: 1.0088 - mean_absolute_error: 0.8357 4/45 [=>............................] - ETA: 0s - loss: 0.9996 - mean_absolute_error: 0.8420 7/45 [===>..........................] - ETA: 0s - loss: 1.0295 - mean_absolute_error: 0.851510/45 [=====>........................] - ETA: 0s - loss: 1.0470 - mean_absolute_error: 0.856812/45 [=======>......................] - ETA: 0s - loss: 1.0364 - mean_absolute_error: 0.851215/45 [=========>....................] - ETA: 0s - loss: 1.0226 - mean_absolute_error: 0.843518/45 [===========>..................] - ETA: 0s - loss: 1.0156 - mean_absolute_error: 0.839621/45 [=============>................] - ETA: 0s - loss: 1.0082 - mean_absolute_error: 0.837324/45 [===============>..............] - ETA: 0s - loss: 0.9870 - mean_absolute_error: 0.827927/45 [=================>............] - ETA: 0s - loss: 0.9693 - mean_absolute_error: 0.820030/45 [===================>..........] - ETA: 0s - loss: 0.9663 - mean_absolute_error: 0.817833/45 [=====================>........] - ETA: 0s - loss: 0.9686 - mean_absolute_error: 0.818036/45 [=======================>......] - ETA: 0s - loss: 0.9597 - mean_absolute_error: 0.812339/45 [=========================>....] - ETA: 0s - loss: 0.9548 - mean_absolute_error: 0.809942/45 [===========================>..] - ETA: 0s - loss: 0.9401 - mean_absolute_error: 0.802745/45 [==============================] - ETA: 0s - loss: 0.9322 - mean_absolute_error: 0.798945/45 [==============================] - 2s 34ms/step - loss: 0.9322 - mean_absolute_error: 0.7989 - val_loss: 6.5085 - val_mean_absolute_error: 1.6302
Epoch 2/10
 1/45 [..............................] - ETA: 0s - loss: 0.8354 - mean_absolute_error: 0.7450 3/45 [=>............................] - ETA: 0s - loss: 0.8782 - mean_absolute_error: 0.7659 6/45 [===>..........................] - ETA: 0s - loss: 0.8996 - mean_absolute_error: 0.7768 9/45 [=====>........................] - ETA: 0s - loss: 0.8642 - mean_absolute_error: 0.757212/45 [=======>......................] - ETA: 0s - loss: 0.8587 - mean_absolute_error: 0.752915/45 [=========>....................] - ETA: 0s - loss: 0.8444 - mean_absolute_error: 0.745718/45 [===========>..................] - ETA: 0s - loss: 0.8334 - mean_absolute_error: 0.739021/45 [=============>................] - ETA: 0s - loss: 0.8194 - mean_absolute_error: 0.732124/45 [===============>..............] - ETA: 0s - loss: 0.8101 - mean_absolute_error: 0.728426/45 [================>.............] - ETA: 0s - loss: 0.8098 - mean_absolute_error: 0.727429/45 [==================>...........] - ETA: 0s - loss: 0.8056 - mean_absolute_error: 0.725932/45 [====================>.........] - ETA: 0s - loss: 0.8043 - mean_absolute_error: 0.724935/45 [======================>.......] - ETA: 0s - loss: 0.8022 - mean_absolute_error: 0.723637/45 [=======================>......] - ETA: 0s - loss: 0.7967 - mean_absolute_error: 0.721040/45 [=========================>....] - ETA: 0s - loss: 0.7900 - mean_absolute_error: 0.717043/45 [===========================>..] - ETA: 0s - loss: 0.7853 - mean_absolute_error: 0.713845/45 [==============================] - 1s 26ms/step - loss: 0.7857 - mean_absolute_error: 0.7141 - val_loss: 6.1646 - val_mean_absolute_error: 1.5797
Epoch 3/10
 1/45 [..............................] - ETA: 0s - loss: 0.6416 - mean_absolute_error: 0.6341 4/45 [=>............................] - ETA: 0s - loss: 0.7674 - mean_absolute_error: 0.6998 7/45 [===>..........................] - ETA: 0s - loss: 0.7641 - mean_absolute_error: 0.703310/45 [=====>........................] - ETA: 0s - loss: 0.7875 - mean_absolute_error: 0.713812/45 [=======>......................] - ETA: 0s - loss: 0.7636 - mean_absolute_error: 0.701415/45 [=========>....................] - ETA: 0s - loss: 0.7579 - mean_absolute_error: 0.698318/45 [===========>..................] - ETA: 0s - loss: 0.7520 - mean_absolute_error: 0.692621/45 [=============>................] - ETA: 0s - loss: 0.7530 - mean_absolute_error: 0.693224/45 [===============>..............] - ETA: 0s - loss: 0.7544 - mean_absolute_error: 0.694827/45 [=================>............] - ETA: 0s - loss: 0.7533 - mean_absolute_error: 0.694030/45 [===================>..........] - ETA: 0s - loss: 0.7511 - mean_absolute_error: 0.692833/45 [=====================>........] - ETA: 0s - loss: 0.7473 - mean_absolute_error: 0.689636/45 [=======================>......] - ETA: 0s - loss: 0.7437 - mean_absolute_error: 0.687438/45 [========================>.....] - ETA: 0s - loss: 0.7429 - mean_absolute_error: 0.687041/45 [==========================>...] - ETA: 0s - loss: 0.7381 - mean_absolute_error: 0.684144/45 [============================>.] - ETA: 0s - loss: 0.7353 - mean_absolute_error: 0.682745/45 [==============================] - 1s 25ms/step - loss: 0.7348 - mean_absolute_error: 0.6824 - val_loss: 6.4608 - val_mean_absolute_error: 1.6276
Epoch 4/10
 1/45 [..............................] - ETA: 0s - loss: 0.7113 - mean_absolute_error: 0.6706 4/45 [=>............................] - ETA: 0s - loss: 0.7541 - mean_absolute_error: 0.6947 7/45 [===>..........................] - ETA: 0s - loss: 0.7703 - mean_absolute_error: 0.701410/45 [=====>........................] - ETA: 0s - loss: 0.7513 - mean_absolute_error: 0.691413/45 [=======>......................] - ETA: 0s - loss: 0.7532 - mean_absolute_error: 0.690116/45 [=========>....................] - ETA: 0s - loss: 0.7327 - mean_absolute_error: 0.677919/45 [===========>..................] - ETA: 0s - loss: 0.7290 - mean_absolute_error: 0.677422/45 [=============>................] - ETA: 0s - loss: 0.7306 - mean_absolute_error: 0.676625/45 [===============>..............] - ETA: 0s - loss: 0.7299 - mean_absolute_error: 0.675528/45 [=================>............] - ETA: 0s - loss: 0.7227 - mean_absolute_error: 0.671631/45 [===================>..........] - ETA: 0s - loss: 0.7242 - mean_absolute_error: 0.671434/45 [=====================>........] - ETA: 0s - loss: 0.7225 - mean_absolute_error: 0.670837/45 [=======================>......] - ETA: 0s - loss: 0.7222 - mean_absolute_error: 0.670040/45 [=========================>....] - ETA: 0s - loss: 0.7191 - mean_absolute_error: 0.668543/45 [===========================>..] - ETA: 0s - loss: 0.7155 - mean_absolute_error: 0.666445/45 [==============================] - 1s 25ms/step - loss: 0.7119 - mean_absolute_error: 0.6644 - val_loss: 6.6499 - val_mean_absolute_error: 1.6746
Epoch 5/10
 1/45 [..............................] - ETA: 0s - loss: 0.7799 - mean_absolute_error: 0.7049 4/45 [=>............................] - ETA: 0s - loss: 0.7405 - mean_absolute_error: 0.6850 7/45 [===>..........................] - ETA: 0s - loss: 0.7290 - mean_absolute_error: 0.676410/45 [=====>........................] - ETA: 0s - loss: 0.7121 - mean_absolute_error: 0.665413/45 [=======>......................] - ETA: 0s - loss: 0.7159 - mean_absolute_error: 0.667016/45 [=========>....................] - ETA: 0s - loss: 0.7145 - mean_absolute_error: 0.665119/45 [===========>..................] - ETA: 0s - loss: 0.7148 - mean_absolute_error: 0.664422/45 [=============>................] - ETA: 0s - loss: 0.7063 - mean_absolute_error: 0.658925/45 [===============>..............] - ETA: 0s - loss: 0.7097 - mean_absolute_error: 0.660027/45 [=================>............] - ETA: 0s - loss: 0.7104 - mean_absolute_error: 0.661030/45 [===================>..........] - ETA: 0s - loss: 0.7091 - mean_absolute_error: 0.660033/45 [=====================>........] - ETA: 0s - loss: 0.7083 - mean_absolute_error: 0.659836/45 [=======================>......] - ETA: 0s - loss: 0.7034 - mean_absolute_error: 0.657539/45 [=========================>....] - ETA: 0s - loss: 0.6969 - mean_absolute_error: 0.654342/45 [===========================>..] - ETA: 0s - loss: 0.6964 - mean_absolute_error: 0.653845/45 [==============================] - ETA: 0s - loss: 0.6971 - mean_absolute_error: 0.654145/45 [==============================] - 1s 25ms/step - loss: 0.6971 - mean_absolute_error: 0.6541 - val_loss: 6.6916 - val_mean_absolute_error: 1.6755
(60, 14)
                  time  watertemp        pH        DO  conductivity   turbidity     codmn      nh3n        tp        tn       day_sin  day_cos  year_sin  year_cos
55 2019-12-31 16:00:00  18.133333  6.985000  4.871333   6847.178667  383.131667  4.966000  2.094692  0.212000  3.673667  8.660254e-01     -0.5 -0.013618  0.999907
56 2019-12-31 20:00:00  17.886667  6.995000  5.177667   8589.174333  262.039333  4.974000  2.062538  0.173000  3.691556  2.543654e-12     -1.0 -0.010752  0.999942
57 2020-01-01 00:00:00  17.640000  7.005000  5.484000  10331.170000  140.947000  4.982000  2.030385  0.134000  3.709444 -8.660254e-01     -0.5 -0.007885  0.999969
58 2020-01-01 04:00:00  17.833333  7.018333  5.350667   8123.018000  163.239667  4.773667  1.998231  0.147333  3.727333 -8.660254e-01      0.5 -0.005017  0.999987
59 2020-01-01 08:00:00  18.026667  7.031667  5.217333   5914.866000  185.532333  4.565333  1.966077  0.160667  3.745222 -7.670342e-12      1.0 -0.002150  0.999998
name:  GRU
(42, 4)
          tn
0   3.678244
1   3.673664
2   3.631908
3   3.382730
4   3.365793
5   3.476780
6   3.399494
7   3.388304
8   3.695762
9   3.411560
10  3.467473
11  3.565294
12  3.424907
13  3.276951
14  3.597569
15  3.709825
16  3.591627
17  3.854071
18  3.508458
19  3.304890
20  3.597130
21  3.665437
22  3.696419
23  3.640341
24  3.460372
25  3.666203
26  3.502429
27  3.488961
28  3.462296
29  3.692860
30  3.606526
31  3.454346
32  3.639753
33  3.509375
34  3.470531
35  3.512535
36  3.515867
37  3.143077
38  3.759408
39  3.568384
40  3.435769
41  3.694807
write 2020-01-01 08:00:00 GRU data done.
...........] - ETA: 0s - loss: 0.5972 - mean_absolute_error: 0.598911/46 [======>.......................] - ETA: 0s - loss: 0.6187 - mean_absolute_error: 0.612414/46 [========>.....................] - ETA: 0s - loss: 0.6260 - mean_absolute_error: 0.614217/46 [==========>...................] - ETA: 0s - loss: 0.6273 - mean_absolute_error: 0.614121/46 [============>.................] - ETA: 0s - loss: 0.6449 - mean_absolute_error: 0.624825/46 [===============>..............] - ETA: 0s - loss: 0.6567 - mean_absolute_error: 0.630929/46 [=================>............] - ETA: 0s - loss: 0.6666 - mean_absolute_error: 0.635432/46 [===================>..........] - ETA: 0s - loss: 0.6714 - mean_absolute_error: 0.638335/46 [=====================>........] - ETA: 0s - loss: 0.6628 - mean_absolute_error: 0.632938/46 [=======================>......] - ETA: 0s - loss: 0.6613 - mean_absolute_error: 0.632642/46 [==========================>...] - ETA: 0s - loss: 0.6553 - mean_absolute_error: 0.629846/46 [==============================] - ETA: 0s - loss: 0.6546 - mean_absolute_error: 0.629446/46 [==============================] - 1s 20ms/step - loss: 0.6546 - mean_absolute_error: 0.6294 - val_loss: 7.1998 - val_mean_absolute_error: 1.7126
Epoch 8/10
 1/46 [..............................] - ETA: 0s - loss: 0.6415 - mean_absolute_error: 0.6041 4/46 [=>............................] - ETA: 0s - loss: 0.6047 - mean_absolute_error: 0.5987 7/46 [===>..........................] - ETA: 0s - loss: 0.6028 - mean_absolute_error: 0.601210/46 [=====>........................] - ETA: 0s - loss: 0.6141 - mean_absolute_error: 0.609913/46 [=======>......................] - ETA: 0s - loss: 0.6393 - mean_absolute_error: 0.624216/46 [=========>....................] - ETA: 0s - loss: 0.6419 - mean_absolute_error: 0.623820/46 [============>.................] - ETA: 0s - loss: 0.6470 - mean_absolute_error: 0.625924/46 [==============>...............] - ETA: 0s - loss: 0.6467 - mean_absolute_error: 0.624728/46 [=================>............] - ETA: 0s - loss: 0.6506 - mean_absolute_error: 0.625732/46 [===================>..........] - ETA: 0s - loss: 0.6512 - mean_absolute_error: 0.625736/46 [======================>.......] - ETA: 0s - loss: 0.6484 - mean_absolute_error: 0.624139/46 [========================>.....] - ETA: 0s - loss: 0.6492 - mean_absolute_error: 0.624543/46 [===========================>..] - ETA: 0s - loss: 0.6510 - mean_absolute_error: 0.625946/46 [==============================] - 1s 20ms/step - loss: 0.6464 - mean_absolute_error: 0.6236 - val_loss: 7.3610 - val_mean_absolute_error: 1.7355
Epoch 9/10
 1/46 [..............................] - ETA: 0s - loss: 0.7466 - mean_absolute_error: 0.6909 4/46 [=>............................] - ETA: 0s - loss: 0.6293 - mean_absolute_error: 0.6100 7/46 [===>..........................] - ETA: 0s - loss: 0.6096 - mean_absolute_error: 0.600910/46 [=====>........................] - ETA: 0s - loss: 0.6037 - mean_absolute_error: 0.598913/46 [=======>......................] - ETA: 0s - loss: 0.6233 - mean_absolute_error: 0.612316/46 [=========>....................] - ETA: 0s - loss: 0.6218 - mean_absolute_error: 0.610619/46 [===========>..................] - ETA: 0s - loss: 0.6316 - mean_absolute_error: 0.615122/46 [=============>................] - ETA: 0s - loss: 0.6348 - mean_absolute_error: 0.616125/46 [===============>..............] - ETA: 0s - loss: 0.6459 - mean_absolute_error: 0.622028/46 [=================>............] - ETA: 0s - loss: 0.6429 - mean_absolute_error: 0.620731/46 [===================>..........] - ETA: 0s - loss: 0.6467 - mean_absolute_error: 0.622534/46 [=====================>........] - ETA: 0s - loss: 0.6468 - mean_absolute_error: 0.622437/46 [=======================>......] - ETA: 0s - loss: 0.6397 - mean_absolute_error: 0.618641/46 [=========================>....] - ETA: 0s - loss: 0.6393 - mean_absolute_error: 0.618145/46 [============================>.] - ETA: 0s - loss: 0.6382 - mean_absolute_error: 0.616946/46 [==============================] - 1s 20ms/step - loss: 0.6387 - mean_absolute_error: 0.6170 - val_loss: 7.3934 - val_mean_absolute_error: 1.7422
(42, 14)
                  time  watertemp        pH        DO  conductivity   turbidity     codmn      nh3n        tp        tn       day_sin  day_cos  year_sin  year_cos
37 2019-12-31 16:00:00  18.133333  6.985000  4.871333   6847.178667  383.131667  4.966000  2.094692  0.212000  3.673667  8.660254e-01     -0.5 -0.013618  0.999907
38 2019-12-31 20:00:00  17.886667  6.995000  5.177667   8589.174333  262.039333  4.974000  2.062538  0.173000  3.691556  2.543654e-12     -1.0 -0.010752  0.999942
39 2020-01-01 00:00:00  17.640000  7.005000  5.484000  10331.170000  140.947000  4.982000  2.030385  0.134000  3.709444 -8.660254e-01     -0.5 -0.007885  0.999969
40 2020-01-01 04:00:00  17.833333  7.018333  5.350667   8123.018000  163.239667  4.773667  1.998231  0.147333  3.727333 -8.660254e-01      0.5 -0.005017  0.999987
41 2020-01-01 08:00:00  18.026667  7.031667  5.217333   5914.866000  185.532333  4.565333  1.966077  0.160667  3.745222 -7.670342e-12      1.0 -0.002150  0.999998
name:  LSTM
(42, 4)
          tn
0   4.082460
1   4.113993
2   4.001419
3   4.336412
4   4.145123
5   4.174489
6   4.085407
7   4.052206
8   4.345201
9   4.279994
10  4.147081
11  4.282671
12  4.236386
13  4.168911
14  4.101610
15  4.026996
16  4.056322
17  4.042823
18  3.945853
19  4.200114
20  4.107517
21  4.255688
22  4.257063
23  4.177448
24  4.227025
25  4.217421
26  4.205945
27  4.113396
28  4.204169
29  4.244630
30  4.097162
31  4.311831
32  4.056751
33  4.106589
34  3.883840
35  3.704056
36  4.186595
37  4.110441
38  4.216703
39  4.031010
40  3.936706
41  4.099847
write 2020-01-01 08:00:00 LSTM data done.
