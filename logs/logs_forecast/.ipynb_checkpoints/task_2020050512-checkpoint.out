2020-10-20 16:51:47.429625: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /public/software/pgi/linux86-64/10.2/lib:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/composer_xe_2011_sp1.7.256/compiler/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/compiler/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mkl/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/compiler/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/compiler/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mkl/lib/intel64:/usr/local:/usr/lib:/lib:/lib64:/usr/lib64:/usr/local/lib64:/usr/local/lib:/usr/local/grads/lib:/public/software/intel/impi/4.1.0.024/lib:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mpirt/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/mpirt/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/impi/4.1.0.024/mic/lib
2020-10-20 16:51:47.429685: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
INFO:fbprophet:Disabling yearly seasonality. Run prophet with yearly_seasonality=True to override this.
Initial log joint probability = -18.6462
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
      99       123.565   7.33732e-06       73.5528      0.2988      0.2988      126   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     166       123.909   8.69461e-05       93.4305   1.076e-06       0.001      252  LS failed, Hessian reset 
     199       123.914   1.36921e-07       78.9356           1           1      291   
    Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes 
     206       123.914   7.19982e-09       79.5874       0.246       0.246      301   
Optimization terminated normally: 
  Convergence detected: absolute parameter change was below tolerance
INFO:utils.LogUtils:Forecast [白马寺] [2020/05/05 12] [tn]done.
INFO:utils.LogUtils:Insert [白马寺] [2020/05/05 16] [tn] forecast data done.
INFO:utils.LogUtils:[白马寺] close session done.
write 2020-05-05 12:00:00 Fbprophet data done.
public/software/intel/composer_xe_2011_sp1.7.256/mpirt/lib/intel64:/public/software/intel/composer_xe_2011_sp1.7.256/debugger/lib/intel64:/public/software/intel/impi/4.1.0.024/intel64/lib:/public/software/intel/impi/4.1.0.024/mic/lib
2020-10-20 16:51:54.541087: W tensorflow/stream_executor/cuda/cuda_driver.cc:312] failed call to cuInit: UNKNOWN ERROR (303)
2020-10-20 16:51:54.541128: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (node2): /proc/driver/nvidia/version does not exist
2020-10-20 16:51:54.551927: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2400055000 Hz
2020-10-20 16:51:54.552232: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2b844403a4c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-10-20 16:51:54.552268: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
This Train Shape: (2191, 10)
This Predict Shape: (42, 10)
(1533, 13)
                     watertemp        pH  ...  year_sin  year_cos
time                                      ...                    
2019-05-14 04:00:00  21.000000  7.442000  ...  0.754222 -0.656619
2019-10-22 12:00:00  18.630000  7.780000  ... -0.939333  0.343007
2019-11-26 20:00:00  11.820000  8.020000  ... -0.575200  0.818013
2019-08-29 16:00:00  27.115385  7.466923  ... -0.838666 -0.544646
2019-07-08 12:00:00  28.100000  7.490000  ... -0.097264 -0.995259

[5 rows x 13 columns]
['codmn', 'nh3n', 'tp', 'tn']
Total Width:   84

Input Indices: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41]

Label Indices: [42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65
 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83]

Label Column Names: ['codmn', 'nh3n', 'tp', 'tn']
Epoch 1/10
 1/46 [..............................] - ETA: 0s - loss: 0.8652 - mean_absolute_error: 0.6837 4/46 [=>............................] - ETA: 0s - loss: 0.8144 - mean_absolute_error: 0.6998 8/46 [====>.........................] - ETA: 0s - loss: 0.8011 - mean_absolute_error: 0.696612/46 [======>.......................] - ETA: 0s - loss: 0.8294 - mean_absolute_error: 0.698816/46 [=========>....................] - ETA: 0s - loss: 0.8470 - mean_absolute_error: 0.703920/46 [============>.................] - ETA: 0s - loss: 0.8670 - mean_absolute_error: 0.710324/46 [==============>...............] - ETA: 0s - loss: 0.8741 - mean_absolute_error: 0.710728/46 [=================>............] - ETA: 0s - loss: 0.8612 - mean_absolute_error: 0.706632/46 [===================>..........] - ETA: 0s - loss: 0.8652 - mean_absolute_error: 0.707436/46 [======================>.......] - ETA: 0s - loss: 0.8613 - mean_absolute_error: 0.705039/46 [========================>.....] - ETA: 0s - loss: 0.8576 - mean_absolute_error: 0.703043/46 [===========================>..] - ETA: 0s - loss: 0.8646 - mean_absolute_error: 0.703846/46 [==============================] - 1s 31ms/step - loss: 0.8606 - mean_absolute_error: 0.7017 - val_loss: 20.6423 - val_mean_absolute_error: 3.1461
Epoch 2/10
 1/46 [..............................] - ETA: 0s - loss: 0.7672 - mean_absolute_error: 0.6553 5/46 [==>...........................] - ETA: 0s - loss: 0.6555 - mean_absolute_error: 0.6194 9/46 [====>.........................] - ETA: 0s - loss: 0.7072 - mean_absolute_error: 0.641413/46 [=======>......................] - ETA: 0s - loss: 0.7348 - mean_absolute_error: 0.650316/46 [=========>....................] - ETA: 0s - loss: 0.7221 - mean_absolute_error: 0.645919/46 [===========>..................] - ETA: 0s - loss: 0.7185 - mean_absolute_error: 0.643922/46 [=============>................] - ETA: 0s - loss: 0.7367 - mean_absolute_error: 0.649425/46 [===============>..............] - ETA: 0s - loss: 0.7371 - mean_absolute_error: 0.648829/46 [=================>............] - ETA: 0s - loss: 0.7285 - mean_absolute_error: 0.645732/46 [===================>..........] - ETA: 0s - loss: 0.7280 - mean_absolute_error: 0.646135/46 [=====================>........] - ETA: 0s - loss: 0.7242 - mean_absolute_error: 0.645038/46 [=======================>......] - ETA: 0s - loss: 0.7272 - mean_absolute_error: 0.645841/46 [=========================>....] - ETA: 0s - loss: 0.7205 - mean_absolute_error: 0.643545/46 [============================>.] - ETA: 0s - loss: 0.7240 - mean_absolute_error: 0.644546/46 [==============================] - 1s 21ms/step - loss: 0.7243 - mean_absolute_error: 0.6446 - val_loss: 20.3511 - val_mean_absolute_error: 3.1208
Epoch 3/10
 1/46 [..............................] - ETA: 0s - loss: 0.6395 - mean_absolute_error: 0.6213 5/46 [==>...........................] - ETA: 0s - loss: 0.6844 - mean_absolute_error: 0.6339 9/46 [====>.........................] - ETA: 0s - loss: 0.6852 - mean_absolute_error: 0.630513/46 [=======>......................] - ETA: 0s - loss: 0.6515 - mean_absolute_error: 0.619317/46 [==========>...................] - ETA: 0s - loss: 0.6531 - mean_absolute_error: 0.618621/46 [============>.................] - ETA: 0s - loss: 0.6490 - mean_absolute_error: 0.618425/46 [===============>..............] - ETA: 0s - loss: 0.6653 - mean_absolute_error: 0.623829/46 [=================>............] - ETA: 0s - loss: 0.6731 - mean_absolute_error: 0.626233/46 [====================>.........] - ETA: 0s - loss: 0.6769 - mean_absolute_error: 0.627437/46 [=======================>......] - ETA: 0s - loss: 0.6777 - mean_absolute_error: 0.627840/46 [=========================>....] - ETA: 0s - loss: 0.6806 - mean_absolute_error: 0.628644/46 [===========================>..] - ETA: 0s - loss: 0.6689 - mean_absolute_error: 0.625146/46 [==============================] - 1s 19ms/step - loss: 0.6715 - mean_absolute_error: 0.6258 - val_loss: 20.4617 - val_mean_absolute_error: 3.1301
Epoch 4/10
 1/46 [..............................] - ETA: 0s - loss: 0.6317 - mean_absolute_error: 0.6092 5/46 [==>...........................] - ETA: 0s - loss: 0.6402 - mean_absolute_error: 0.6122 9/46 [====>.........................] - ETA: 0s - loss: 0.6246 - mean_absolute_error: 0.607013/46 [=======>......................] - ETA: 0s - loss: 0.6217 - mean_absolute_error: 0.605317/46 [==========>...................] - ETA: 0s - loss: 0.6292 - mean_absolute_error: 0.610421/46 [============>.................] - ETA: 0s - loss: 0.6331 - mean_absolute_error: 0.610625/46 [===============>..............] - ETA: 0s - loss: 0.6342 - mean_absolute_error: 0.610329/46 [=================>............] - ETA: 0s - loss: 0.6291 - mean_absolute_error: 0.609033/46 [====================>.........] - ETA: 0s - loss: 0.6403 - mean_absolute_error: 0.612837/46 [=======================>......] - ETA: 0s - loss: 0.6472 - mean_absolute_error: 0.614840/46 [=========================>....] - ETA: 0s - loss: 0.6522 - mean_absolute_error: 0.616144/46 [===========================>..] - ETA: 0s - loss: 0.6487 - mean_absolute_error: 0.615046/46 [==============================] - 1s 19ms/step - loss: 0.6485 - mean_absolute_error: 0.6150 - val_loss: 20.5555 - val_mean_absolute_error: 3.1381
Epoch 5/10
 1/46 [..............................] - ETA: 0s - loss: 0.6954 - mean_absolute_error: 0.6377 5/46 [==>...........................] - ETA: 0s - loss: 0.6106 - mean_absolute_error: 0.6068 9/46 [====>.........................] - ETA: 0s - loss: 0.6073 - mean_absolute_error: 0.607213/46 [=======>......................] - ETA: 0s - loss: 0.6083 - mean_absolute_error: 0.603117/46 [==========>...................] - ETA: 0s - loss: 0.6010 - mean_absolute_error: 0.595821/46 [============>.................] - ETA: 0s - loss: 0.6090 - mean_absolute_error: 0.599925/46 [===============>..............] - ETA: 0s - loss: 0.6029 - mean_absolute_error: 0.597229/46 [=================>............] - ETA: 0s - loss: 0.6133 - mean_absolute_error: 0.600133/46 [====================>.........] - ETA: 0s - loss: 0.6222 - mean_absolute_error: 0.604037/46 [=======================>......] - ETA: 0s - loss: 0.6203 - mean_absolute_error: 0.602840/46 [=========================>....] - ETA: 0s - loss: 0.6206 - mean_absolute_error: 0.602444/46 [===========================>..] - ETA: 0s - loss: 0.6283 - mean_absolute_error: 0.604646/46 [==============================] - 1s 20ms/step - loss: 0.6277 - mean_absolute_error: 0.6046 - val_loss: 20.5239 - val_mean_absolute_error: 3.1305
                   time  watertemp        pH  ...  day_cos  year_sin  year_cos
12  2020-04-30 16:00:00  22.930000  8.170000  ...     -0.5  0.878959 -0.476897
41  2020-05-05 12:00:00  22.818462  7.597846  ...      0.5  0.836316 -0.548248
27  2020-05-03 04:00:00  24.060000  7.883000  ...      0.5  0.857643 -0.514246
13  2020-04-30 20:00:00  22.690000  8.113000  ...     -1.0  0.877588 -0.479415
3   2020-04-29 04:00:00  20.850000  7.816000  ...      0.5  0.890971 -0.454060

[5 rows x 14 columns]
name:  LSTM
(42, 4)
          tn
0   6.358713
1   6.358713
2   6.358713
3   6.358713
4   6.358713
5   6.358713
6   6.358713
7   6.358713
8   6.358713
9   6.358713
10  6.358713
11  6.358713
12  6.358713
13  6.358713
14  6.358713
15  6.365221
16  6.395956
17  6.358713
18  6.383160
19  6.360696
20  6.358713
21  6.358713
22  6.358713
23  6.358713
24  6.358713
25  6.358713
26  6.358713
27  6.358713
28  6.358713
29  6.358713
30  6.358713
31  6.358713
32  6.372832
33  6.358713
34  6.358713
35  6.359224
36  6.358713
37  6.416346
38  6.394975
39  6.358713
40  6.358713
41  6.358713
write 2020-05-05 12:00:00 LSTM data done.
